# Current Task
* This file only keeps 3 days of history

## July 12
* Running command 
  * Normal:
    * CUDA_VISIBLE_DEVICES=0 fairseq-train --task mytranslation  data-bin/iwslt14.tokenized.de-en --arch transformer_iwslt_de_en --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9, 0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.3 --weight-decay 0.0001 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 4096 --eval-bleu --eval-bleu-args '{"beam": 5, "max_len_a": 1.2, "max_len_b": 10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --eval-bleu-print-samples --best-checkpoint-metric bleu --maximize-best-checkpoint-metric
  * Customize task:
    * CUDA_VISIBLE_DEVICES=0 fairseq-train --task mytranslation  data-bin/iwslt14.tokenized.de-en --arch transformer_iwslt_de_en --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9, 0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.3 --weight-decay 0.0001 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 4096 --eval-bleu --eval-bleu-args '{"beam": 5, "max_len_a": 1.2, "max_len_b": 10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --eval-bleu-print-samples --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --eval-bleu-print-samples-with-last-sentence
    * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m07 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 13234 --eval-bleu-print-samples
  
    * Note that, in debug mode, we are using transformer_iwslt_de_en, not transformer_wmt_en_de
      * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch transformer_iwslt_de_en --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --eval-bleu-print-samples-with-last-sentence
      
    * My model
      * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch standard_transformer --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --eval-bleu-print-samples-with-last-sentence
      * Try: CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m14 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 13234 --eval-bleu-print-samples-with-last-sentence
      * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch standard_transformer --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --num-workers 4 --eval-bleu-print-samples-with-last-sentence --wandb-project test-drive --seed 13234

* Visit line 281 of faireq_cli/train.py to check wandb
* Visit fairseq/logging/progress_bar.py to customize wandb with new log
* Just need to call WandBProgressBarWrapper->log (here progress.log)
* Check metric.py. The problem is now turning to:
  * Find the bleu score
  * Should we log it back immediately by the metric function?
  * Check trainer.py line 904

  * Debug
    * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/debug/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch standard_transformer --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --num-workers 4 --eval-bleu-print-samples-with-last-sentence --wandb-project test-drive --seed 13234
  * Re-runing: CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m14 --task mytranslation --arch standard_transformer --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 18234 --eval-bleu-print-samples-with-last-sentence
  * Run evaluate:
    * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m-debug-last-bleu/checkpoint_last.pt --batch-size 128 --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --remove-bpe --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/output_en-ru --scoring sacrebleu
    * show result: /home/cl/huyhien-v/Workspace/MT/my_fairseq/fairseq/supporting_scripts/extract_ouput.sh output_en-ru/generate-test.txt

  * Check checkpoint:
    * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/my_fairseq/fairseq/data-bin/iwslt14.tokenized.de-en --arch tutorial_simple_lstm   --encoder-dropout 0.2 --decoder-dropout 0.2 --optimizer adam --lr 0.005 --lr-shrink 0.5 --max-tokens 12000 --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/debug_checkpoints/checkpoints
    * Check trainer.load_checkpoint; and fairseq_model.py line 102; and module.py line 1171
    * Check fconv_self_att.py to see example of frozen params

  * Debug bleu last:
    * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m07 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 18234 --eval-bleu-print-samples-with-last-sentence --batch-size 10 #--max-tokens 1000  --scoring bleu
    * August 05: Use this to debug:
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --eval-bleu-print-samples-with-last-sentence --batch-size 40 --bpe subword_nmt --wandb-project voita-en-ru-1_5m --seed 18234 
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --eval-bleu-print-samples-with-last-sentence --batch-size 40 --bpe subword_nmt --eval-test-set --eval-multiple-bleu


      * Return bleu in string: 'BLEU4 = 24.03, 20.0/20.0/25.0/33.3 (BP=1.000, ratio=1.667, syslen=5, reflen=3)'
    * Note that --eval-bleu use sacrebleu as default. Let remove it
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m07 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens 1000 --keep-last-epochs 5 --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 18234 --eval-bleu-print-samples-with-last-sentence --scoring bleu
  
    * score: fairseq-score --sys sent09.hypo.txt --ref sent09.ref.txt
    * multibleu: perl $myfairseq/supporting_scripts/multi-bleu.perl -lc sent09.ref.txt < sent09.hypo.txt
    * Thử từng setting
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00 --task mytranslation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --scoring bleu --valid-subset test
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/data-bin/voita-en-ru-1_5m00  --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --scoring bleu --valid-subset test --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --batch-size 40 --bpe subword_nmt --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m
      
       --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-detok moses --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_original/checkpoints/voita-en-ru-1_5m --num-workers 4 --update-freq 8 --eval-bleu-print-samples-with-last-sentence --batch-size 40 --bpe subword_nmt --eval-test-set --eval-multiple-bleu

  * 12/08: 
    * Current command:
      * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/data-bin/voita-en-ru-1_5m00 --task document-translation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 5e-4 --lr-scheduler inverse_sqrt --warmup-updates 4000 --dropout 0.1 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/checkpoints/voita-en-ru-1_5m --num-workers 4   --batch-size 40 --eval-multiple-bleu --eval-test-set 
      * --update-freq 8 --wandb-project voita-en-ru-1_5m --seed 18234
    * Vaswani 17:
      * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/data-bin/voita-en-ru-1_5m00 --task document-translation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens  4096  --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/checkpoints/voita-en-ru-1_5m --num-workers 4   --batch-size 40 --eval-multiple-bleu --eval-test-set


             - 
              
             \
                 
              --update-freq 2 --no-progress-bar --log-format json --log-interval 50\
             --save-interval-updates  1000 --keep-interval-updates 20

      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/data-bin/voita-en-ru-1_5m00 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/checkpoints/voita-en-ru-1_5m/checkpoint_last.pt --batch-size 128 --beam 4 --remove-bpe --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/output_en-ru

      * CUDA_VISIBLE_DEVICES=0 python generate.py data-bin/wmt16_en_de_bpe32k  \
         --path checkpoints/$model --gen-subset $subset\
           --beam 4 --batch-size 128 --remove-bpe  --lenpen 0.6

    need to check final init of generator function:
      beam: 4
      max_len_a = 1.2
      max_len_b = 10
      min_len = 1
      normalize_scores=Tru
      len_penalty=1
      unk_penalty=0 
      temprature=1
      match_source_len=False
      no_repeat_ngram_size=0 
      search_strategy: BeamSearch()
      extra_gen_cls_kwargs: {}
    generate.py
      beam :4
      max_len_a = 0
      max_len_b = 200
      min_len=1
      normalize_scores = True
      len_penalty=0.6
      unk_penalty=0
      temprature=1
      match_source_len=False
      no_repeat_ngram_size=0 
      search_strategy: BeamSearch()
      {'lm_model': None, 'lm_weight': 0.0}
      


    * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/data-bin/voita-en-ru-1_5m00 --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5/checkpoints/voita-en-ru-1_5m --num-workers 4   --batch-size 40 --update-freq 8



    * CUDA_VISIBLE_DEVICES=2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_bpe_all/data-bin/voita-en-ru-1_5m00 --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_bpe_all/checkpoints/voita-en-ru-1_5m --num-workers 4 --max-tokens  4096 --update-freq 8  --batch-size 40 

--share-all-embeddings

  * Quick question:
    - Should we take in on de-bpe step?
    - Or generate steps?
  * Trying model parallel:
    * CUDA_VISIBLE_DEVICES=1,2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_bpe_all/data-bin/voita-en-ru-1_5m00 --arch transformer_wmt_en_de_model_parallel --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_bpe_all/checkpoints/voita-en-ru-1_5m --num-workers 4 --max-tokens  4096 --update-freq 8  --batch-size 40 --model-parallel-size 2
    * CUDA_VISIBLE_DEVICES=1,2 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_bpe_all/data-bin/voita-en-ru-1_5m00 --arch transformer_wmt_en_de_model_parallel --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --keep-last-epochs 5 --num-workers 4 --max-tokens  4096 --update-freq 8  --model-parallel-size 2

  * Transformer of Vaswani for 6M
    * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline_transformer_en-ru_6M05 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens  4096  --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/checkpoints/baseline6 --num-workers 4    --eval-multiple-bleu --eval-test-set --update-freq 8 --wandb-project baseline_transformer_6M --seed 2208
    * New dataset format:
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline6m --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens  4096  --keep-last-epochs 5 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/checkpoints/baseline6m --num-workers 4 --eval-multiple-bleu --eval-test-set --update-freq 8


      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline6 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens  4096  --keep-last-epochs 15 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/checkpoints/baseline6 --num-workers 4 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1
  * 
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_joined_dict/data-bin/baseline1_5_last_sent_joined_dict --task document-translation --arch transformer_wmt_en_de --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1 --max-tokens  4096  --keep-last-epochs 15 --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_joined_dict/checkpoints/baseline1_5_last_sent_joined_dict --num-workers 4 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --share-all-embeddings --share-decoder-input-output-embed 


      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent/data-bin/baseline1_5_last_sent --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent/checkpoints/baseline1_5_last_sent/checkpoint_best.pt --batch-size 128 --beam 4 --remove-bpe --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent/output_en-ru
      * 
      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_joined_dict/data-bin/baseline1_5_last_sent_joined_dict --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_joined_dict/checkpoints/baseline1_5_last_sent_joined_dict/checkpoint_best.pt --batch-size 128 --beam 4 --remove-bpe --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_joined_dict/output_en-ru
      * ??--dropout 0.3 --attention-dropout 0.1 --weight-dropout 0.1
      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/data-bin/baseline6 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/checkpoints/baseline6/checkpoint_best.pt --batch-size 128 --beam 4 --remove-bpe --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6/output_en-ru 
      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline6_unbpe_target/data-bin/baseline6m --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6_unbpe_target/checkpoints/baseline6m/checkpoint_last.pt --batch-size 128 --beam 4 --remove-bpe=subword_nmt --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6_unbpe_target/output_en-ru
      * 
      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split00 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/checkpoints/baseline1_5_last_sent_split/checkpoint_last.pt --batch-size 128 --beam 4 --remove-bpe=subword_nmt --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/output_en-ru
      
      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split14 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/checkpoints/baseline6split --num-workers 4 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --max-tokens  4096 --wandb-project baseline_transformer_6M --seed 2908 --keep-last-epochs 15  --batch-size 128

      * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k15:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k16:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k17:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k18:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k19:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k20:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k21:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k22:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k23:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k25:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k26:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k27:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k28:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k29 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":1.2,"max_len_b":10}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/checkpoints/baseline6m_split_200k --num-workers 14 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --max-tokens  4096 --activation-dropout 0.1 --wandb-project baseline6m_split_200k --seed 2908 --fixed-validation-seed 2908 --keep-last-epochs 15  --batch-size 128
      * fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k00 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/checkpoints/baseline6m_split_200k/checkpoint297.pt --batch-size 128 --beam 4 --remove-bpe=subword_nmt --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/output_en-ru
  
      * CUDA_VISIBLE_DEVICES=0 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split04:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split14 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":0.0,"max_len_b":10,"max_len_a":200,"min_len":1,"unken":0.0,"temprature":1.0}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/checkpoints/baseline1_5_last_sent_split --num-workers 10 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --activation-dropout 0.1 --max-tokens  4096 --seed 1102 --fixed-validation-seed 1102 --wandb-project baseline1_5_last_sent_split --keep-last-epochs 15  --batch-size 128
      * Debug:
        * CUDA_VISIBLE_DEVICES=0 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split14 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":0.0,"max_len_b":10,"max_len_a":200,"min_len":1,"unken":0.0,"temprature":1.0}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/checkpoints/baseline1_5_last_sent_split --num-workers 4 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --activation-dropout 0.1 --max-tokens  4096 --seed 1102 --fixed-validation-seed 1102
        * Result on test when training: test_all_sents 27.85
        * CUDA_VISIBLE_DEVICES=0 fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/data-bin/baseline1_5_last_sent_split14 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/checkpoints/baseline1_5_last_sent_split/checkpoint_last.pt --batch-size 128 --beam 4 --remove-bpe=subword_nmt --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline1_5_last_sent_split/output_en-ru --seed 1102 --fixed-validation-seed 1102
        * Result on baseline1_5_last_sent_split: around 6 epoch, score: 29.12 at checkpoint 190 (default settings of transformer as voita et al. 19)
        * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k15:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k16:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k17:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k18:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k19:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k20:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k21:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k22:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k23:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k25:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k26:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k27:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k28:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k29 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":0.0,"max_len_b":10,"max_len_a":200,"min_len":1,"unken":0.0,"temprature":1.0}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/checkpoints/baseline6m_split_200k --num-workers 14 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --activation-dropout 0.1 --max-tokens 4096 --wandb-project baseline6m_split_200k --seed 1102 --fixed-validation-seed 1102 --keep-last-epochs 30  --batch-size 128
        * CUDA_VISIBLE_DEVICES=0 fairseq-generate /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k00 --path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/checkpoints/baseline6m_split_200k/checkpoint_last.pt --batch-size 128 --beam 4 --remove-bpe=subword_nmt --lenpen 0.6 --results-path /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/output_en-ru --seed 1102 

/home/cl/huyhien-v/Workspace/MT/experiments/baseline6split/data-bin/baseline6split00


* Compare to Voita et al's settings
  * Voita
    * "num_layers": 6, OK
      "num_heads": 8, OK
      "ff_size": 2048, OK encoder_ffn_embed_dim
      "ffn_type": "conv_relu", hmm. is it default of fairseq for transformer?
      "hid_size": 512, hmm, not sure
      "emb_size": 512, Ok -> embeddim 
      "res_steps": "nlda", 
    
      "rescale_emb": True, take sqrt of value. Is it default in fairseq?
      "inp_emb_bias": True,
      "normalize_out": True,
      "share_emb": False,
      "replace": 0,
    
      "relu_dropout": 0.1, use in FFN in decoder. is this activation_dropout? check by add activation_dropout to 0.1?
      "res_dropout": 0.1, residual layer dropout. let check fairseq
      "attn_dropout": 0.1, NOT ok -> OK
      "label_smoothing": 0.1,--label-smoothing 0.1
    
      "translator": "ingraph",
      "beam_size": 4, OK 
      "beam_spread": 3,
      "len_alpha": 0.6,
      "attn_beta": 0,
      https://github.com/pytorch/fairseq/blob/5277ec47bdb51165592596e2a2c4c7ee650d9958/fairseq/tasks/fairseq_task.py#L448
      '{"beam":4,"max_len_a":0.0,"max_len_b":10,"max_len_a":200,"min_len":1,"unken":0.0,"temprature":1.0}'


      check cfg.encoder.normalize_before =True in fairseq/modules/transformer_layer.py

* 07 September
  * Verify running for 6m dataset en-ru
    * CUDA_VISIBLE_DEVICES=1 fairseq-train /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k00:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k01:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k02:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k03:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k05:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k06:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k07:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k08:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k09:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k10:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k11:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k12:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k13:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k15:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k16:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k17:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k18:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k19:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k20:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k21:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k22:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k23:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k25:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k26:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k27:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k28:/home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/data-bin/baseline6m_split_200k29 --task document-translation --arch transformer_wmt_en_de --share-decoder-input-output-embed --optimizer adam --adam-betas '(0.9,0.98)' --clip-norm 0.0 --lr 0.0007 --lr-scheduler inverse_sqrt --warmup-init-lr 1e-07 --stop-min-lr 1e-09 --warmup-updates 4000 --dropout 0.1 --weight-decay 0.0 --criterion label_smoothed_cross_entropy --label-smoothing 0.1   --eval-bleu --eval-bleu-args '{"beam":4,"max_len_a":0.0,"max_len_b":10,"max_len_a":200,"min_len":1,"unken":0.0,"temprature":1.0}' --eval-bleu-remove-bpe --best-checkpoint-metric bleu --maximize-best-checkpoint-metric --save-dir /home/cl/huyhien-v/Workspace/MT/experiments/baseline6m_split_200k/checkpoints/baseline6m_split_200k --num-workers 14 --eval-multiple-bleu --eval-test-set --update-freq 8 --attention-dropout 0.1 --max-tokens 4096 --wandb-project baseline6m_split_200k --seed 2908 --fixed-validation-seed 2908 --keep-last-epochs 30 